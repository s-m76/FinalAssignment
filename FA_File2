import pickle
import os

class FileHandler:
    def __init__(self, filename):
        self.filename = filename
        if not os.path.exists(filename):
            with open(filename, 'wb') as file:
                pickle.dump([], file)

    # Creates and stores a new object in the file.
    def create(self, obj):
        data = self.read_all()
        data.append(obj)
        self._write(data)

    # Alias for the create method.
    def add(self, obj):
        self.create(obj)

    # Deletes objects matching the given condition.
    def delete(self, condition):
        data = self.read_all()
        data = [item for item in data if not condition(item)]
        self._write(data)

    # Modifies objects that meet the condition using the update function.
    def modify(self, condition, update_function):
        data = self.read_all()
        for item in data:
            if condition(item):
                update_function(item)
        self._write(data)

    # Reads all objects from the file.
    def read_all(self):
        with open(self.filename, 'rb') as file:
            return pickle.load(file)

    # Writes all objects back to the file.
    def _write(self, data):
        with open(self.filename, 'wb') as file:
            pickle.dump(data, file)
